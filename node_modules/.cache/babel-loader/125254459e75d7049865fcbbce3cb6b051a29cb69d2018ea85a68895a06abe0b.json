{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import TaskList from'../Task/TaskList';import supabase from'../../services/supabaseClient';import'./Dashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){const[tasks,setTasks]=useState([]);const[categories,setCategories]=useState([]);const[loading,setLoading]=useState(true);const[activeTab,setActiveTab]=useState('all');const[error,setError]=useState(null);// タスクとカテゴリを取得\nconst fetchTasks=useCallback(async()=>{setLoading(true);setError(null);try{const{data,error}=await supabase.from('tasks').select(`\n          *,\n          categories(id, name, color)\n        `).order('created_at',{ascending:false});if(error){console.error('タスクの取得中にエラーが発生しました:',error);setError('タスクの読み込みに失敗しました。データベースの設定を確認してください。');}else{setTasks(data||[]);setError(null);}}catch(err){console.error('予期しないエラー:',err);setError('接続エラーが発生しました。インターネット接続を確認してください。');}finally{setLoading(false);}},[]);const fetchCategories=useCallback(async()=>{try{const{data,error}=await supabase.from('categories').select('*').order('name',{ascending:true});if(error){console.error('カテゴリの取得中にエラーが発生しました:',error);}else{setCategories(data||[]);}}catch(err){console.error('カテゴリ取得エラー:',err);}},[]);useEffect(()=>{fetchTasks();fetchCategories();},[fetchTasks,fetchCategories]);// タスクのフィルタリング\nconst getFilteredTasks=()=>{switch(activeTab){case'all':return tasks;case'active':return tasks.filter(task=>!task.status);case'completed':return tasks.filter(task=>task.status);default:return tasks;}};const filteredTasks=getFilteredTasks();const activeTasks=tasks.filter(task=>!task.status);const completedTasks=tasks.filter(task=>task.status);// タブ切り替えボタン\nconst TabButton=_ref=>{let{tabKey,label,count,isActive,onClick}=_ref;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onClick(tabKey),className:`tab-button ${isActive?'active':''}`,children:[/*#__PURE__*/_jsx(\"span\",{className:\"tab-label\",children:label}),/*#__PURE__*/_jsx(\"span\",{className:\"tab-count\",children:count})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"dashboard-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-title-section\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"dashboard-title\",children:\"\\u30BF\\u30B9\\u30AF\\u7BA1\\u7406\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-time\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"current-time\",children:new Date().toLocaleTimeString('ja-JP',{hour:'2-digit',minute:'2-digit'})}),/*#__PURE__*/_jsx(\"div\",{className:\"current-date\",children:new Date().toLocaleDateString('ja-JP',{month:'long',day:'numeric',weekday:'short'})})]})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-banner\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"error-content\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{fetchTasks();fetchCategories();},className:\"retry-button\",children:\"\\u518D\\u8A66\\u884C\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"dashboard-controls\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"tab-controls\",children:[/*#__PURE__*/_jsx(TabButton,{tabKey:\"all\",label:\"\\u3059\\u3079\\u3066\",count:tasks.length,isActive:activeTab==='all',onClick:setActiveTab}),/*#__PURE__*/_jsx(TabButton,{tabKey:\"active\",label:\"\\u672A\\u5B8C\\u4E86\",count:activeTasks.length,isActive:activeTab==='active',onClick:setActiveTab}),/*#__PURE__*/_jsx(TabButton,{tabKey:\"completed\",label:\"\\u5B8C\\u4E86\",count:completedTasks.length,isActive:activeTab==='completed',onClick:setActiveTab})]})}),/*#__PURE__*/_jsx(\"div\",{className:`main-content ${loading?'loading':''}`,children:/*#__PURE__*/_jsx(TaskList,{tasks:filteredTasks,categories:categories,loading:loading,refreshTasks:fetchTasks,activeTab:activeTab})})]});}export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","useCallback","TaskList","supabase","jsx","_jsx","jsxs","_jsxs","Dashboard","tasks","setTasks","categories","setCategories","loading","setLoading","activeTab","setActiveTab","error","setError","fetchTasks","data","from","select","order","ascending","console","err","fetchCategories","getFilteredTasks","filter","task","status","filteredTasks","activeTasks","completedTasks","TabButton","_ref","tabKey","label","count","isActive","onClick","className","children","Date","toLocaleTimeString","hour","minute","toLocaleDateString","month","day","weekday","length","refreshTasks"],"sources":["C:/Users/mexer/PR/task-manager-app/src/components/Dashboard/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport TaskList from '../Task/TaskList';\nimport supabase from '../../services/supabaseClient';\nimport './Dashboard.css';\n\nfunction Dashboard() {\n  const [tasks, setTasks] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState('all');\n  const [error, setError] = useState(null);\n\n  // タスクとカテゴリを取得\n  const fetchTasks = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const { data, error } = await supabase\n        .from('tasks')\n        .select(`\n          *,\n          categories(id, name, color)\n        `)\n        .order('created_at', { ascending: false });\n\n      if (error) {\n        console.error('タスクの取得中にエラーが発生しました:', error);\n        setError('タスクの読み込みに失敗しました。データベースの設定を確認してください。');\n      } else {\n        setTasks(data || []);\n        setError(null);\n      }\n    } catch (err) {\n      console.error('予期しないエラー:', err);\n      setError('接続エラーが発生しました。インターネット接続を確認してください。');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const fetchCategories = useCallback(async () => {\n    try {\n      const { data, error } = await supabase\n        .from('categories')\n        .select('*')\n        .order('name', { ascending: true });\n\n      if (error) {\n        console.error('カテゴリの取得中にエラーが発生しました:', error);\n      } else {\n        setCategories(data || []);\n      }\n    } catch (err) {\n      console.error('カテゴリ取得エラー:', err);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchTasks();\n    fetchCategories();\n  }, [fetchTasks, fetchCategories]);\n\n  // タスクのフィルタリング\n  const getFilteredTasks = () => {\n    switch (activeTab) {\n      case 'all':\n        return tasks;\n      case 'active':\n        return tasks.filter(task => !task.status);\n      case 'completed':\n        return tasks.filter(task => task.status);\n      default:\n        return tasks;\n    }\n  };\n\n  const filteredTasks = getFilteredTasks();\n  const activeTasks = tasks.filter(task => !task.status);\n  const completedTasks = tasks.filter(task => task.status);\n\n  // タブ切り替えボタン\n  const TabButton = ({ tabKey, label, count, isActive, onClick }) => (\n    <button\n      onClick={() => onClick(tabKey)}\n      className={`tab-button ${isActive ? 'active' : ''}`}\n    >\n      <span className=\"tab-label\">{label}</span>\n      <span className=\"tab-count\">\n        {count}\n      </span>\n    </button>\n  );\n\n  return (\n    <div className=\"dashboard-container\">\n      {/* ヘッダー */}\n      <header className=\"dashboard-header\">\n        <div className=\"header-content\">\n          <div className=\"header-title-section\">\n            <h1 className=\"dashboard-title\">タスク管理</h1>\n          </div>\n          \n          {/* 時刻表示 */}\n          <div className=\"header-time\">\n            <div className=\"current-time\">\n              {new Date().toLocaleTimeString('ja-JP', { \n                hour: '2-digit', \n                minute: '2-digit' \n              })}\n            </div>\n            <div className=\"current-date\">\n              {new Date().toLocaleDateString('ja-JP', { \n                month: 'long', \n                day: 'numeric',\n                weekday: 'short' \n              })}\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* エラー表示 */}\n      {error && (\n        <div className=\"error-banner\">\n          <div className=\"error-content\">\n            <span className=\"error-message\">{error}</span>\n            <button \n              onClick={() => {\n                fetchTasks();\n                fetchCategories();\n              }}\n              className=\"retry-button\"\n            >\n              再試行\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* タブコントロール - シンプル化 */}\n      <div className=\"dashboard-controls\">\n        <div className=\"tab-controls\">\n          <TabButton\n            tabKey=\"all\"\n            label=\"すべて\"\n            count={tasks.length}\n            isActive={activeTab === 'all'}\n            onClick={setActiveTab}\n          />\n          \n          <TabButton\n            tabKey=\"active\"\n            label=\"未完了\"\n            count={activeTasks.length}\n            isActive={activeTab === 'active'}\n            onClick={setActiveTab}\n          />\n          \n          <TabButton\n            tabKey=\"completed\"\n            label=\"完了\"\n            count={completedTasks.length}\n            isActive={activeTab === 'completed'}\n            onClick={setActiveTab}\n          />\n        </div>\n      </div>\n\n      {/* メインコンテンツ */}\n      <div className={`main-content ${loading ? 'loading' : ''}`}>\n        <TaskList\n          tasks={filteredTasks}\n          categories={categories}\n          loading={loading}\n          refreshTasks={fetchTasks}\n          activeTab={activeTab}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}