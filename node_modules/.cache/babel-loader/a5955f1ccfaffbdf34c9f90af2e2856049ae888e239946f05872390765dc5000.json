{"ast":null,"code":"import React,{useState}from'react';import supabase from'../../services/supabaseClient';import'./Task.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AddTaskModal(_ref){let{categories,onClose,onTaskAdded}=_ref;const[newTask,setNewTask]=useState({title:'',description:'',priority:'中',due_date:'',category_id:''});const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError(null);try{// ユーザーIDの取得\nconst{data:userData}=await supabase.auth.getUser();if(!userData||!userData.user){throw new Error('ユーザー情報が取得できませんでした');}// タスクの追加（user_idを明示的に設定）\nconst{error:insertError}=await supabase.from('tasks').insert([{title:newTask.title,description:newTask.description||null,priority:newTask.priority,due_date:newTask.due_date||null,category_id:newTask.category_id||null,status:false,user_id:userData.user.id}]);if(insertError)throw insertError;onTaskAdded();}catch(err){console.error('タスクの追加中にエラーが発生しました:',err);setError(err.message);}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"modal-title\",children:\"\\u65B0\\u3057\\u3044\\u30BF\\u30B9\\u30AF\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"task-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"new-title\",children:\"\\u30BF\\u30A4\\u30C8\\u30EB\"}),/*#__PURE__*/_jsx(\"input\",{id:\"new-title\",type:\"text\",value:newTask.title,onChange:e=>setNewTask({...newTask,title:e.target.value}),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"new-description\",children:\"\\u8AAC\\u660E\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"new-description\",value:newTask.description,onChange:e=>setNewTask({...newTask,description:e.target.value}),rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"new-priority\",children:\"\\u512A\\u5148\\u5EA6\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"new-priority\",value:newTask.priority,onChange:e=>setNewTask({...newTask,priority:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\\u9AD8\",children:\"\\u9AD8\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u4E2D\",children:\"\\u4E2D\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u4F4E\",children:\"\\u4F4E\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"new-due-date\",children:\"\\u671F\\u9650\\u65E5\"}),/*#__PURE__*/_jsx(\"input\",{id:\"new-due-date\",type:\"date\",value:newTask.due_date,onChange:e=>setNewTask({...newTask,due_date:e.target.value})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"new-category\",children:\"\\u30AB\\u30C6\\u30B4\\u30EA\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"new-category\",value:newTask.category_id,onChange:e=>setNewTask({...newTask,category_id:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u30AB\\u30C6\\u30B4\\u30EA\\u306A\\u3057\"}),categories.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category.id,children:category.name},category.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"cancel-button\",children:\"\\u30AD\\u30E3\\u30F3\\u30BB\\u30EB\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"save-button\",disabled:loading,children:loading?'保存中...':'保存'})]})]})]})});}export default AddTaskModal;","map":{"version":3,"names":["React","useState","supabase","jsx","_jsx","jsxs","_jsxs","AddTaskModal","_ref","categories","onClose","onTaskAdded","newTask","setNewTask","title","description","priority","due_date","category_id","loading","setLoading","error","setError","handleSubmit","e","preventDefault","data","userData","auth","getUser","user","Error","insertError","from","insert","status","user_id","id","err","console","message","className","children","onSubmit","htmlFor","type","value","onChange","target","required","rows","map","category","name","onClick","disabled"],"sources":["C:/Users/mexer/PR/task-manager-app/src/components/Task/AddTaskModal.js"],"sourcesContent":["import React, { useState } from 'react';\nimport supabase from '../../services/supabaseClient';\nimport './Task.css';\n\nfunction AddTaskModal({ categories, onClose, onTaskAdded }) {\n  const [newTask, setNewTask] = useState({\n    title: '',\n    description: '',\n    priority: '中',\n    due_date: '',\n    category_id: ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    try {\n      // ユーザーIDの取得\n      const { data: userData } = await supabase.auth.getUser();\n      if (!userData || !userData.user) {\n        throw new Error('ユーザー情報が取得できませんでした');\n      }\n\n      // タスクの追加（user_idを明示的に設定）\n      const { error: insertError } = await supabase\n        .from('tasks')\n        .insert([{\n          title: newTask.title,\n          description: newTask.description || null,\n          priority: newTask.priority,\n          due_date: newTask.due_date || null,\n          category_id: newTask.category_id || null,\n          status: false,\n          user_id: userData.user.id\n        }]);\n\n      if (insertError) throw insertError;\n\n      onTaskAdded();\n    } catch (err) {\n      console.error('タスクの追加中にエラーが発生しました:', err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal-content\">\n        <h2 className=\"modal-title\">新しいタスク</h2>\n        \n        {error && (\n          <div className=\"error-message\">\n            {error}\n          </div>\n        )}\n        \n        <form onSubmit={handleSubmit} className=\"task-form\">\n          <div className=\"form-field\">\n            <label htmlFor=\"new-title\">\n              タイトル\n            </label>\n            <input\n              id=\"new-title\"\n              type=\"text\"\n              value={newTask.title}\n              onChange={(e) => setNewTask({ ...newTask, title: e.target.value })}\n              required\n            />\n          </div>\n          \n          <div className=\"form-field\">\n            <label htmlFor=\"new-description\">\n              説明\n            </label>\n            <textarea\n              id=\"new-description\"\n              value={newTask.description}\n              onChange={(e) => setNewTask({ ...newTask, description: e.target.value })}\n              rows=\"3\"\n            />\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-field\">\n              <label htmlFor=\"new-priority\">\n                優先度\n              </label>\n              <select\n                id=\"new-priority\"\n                value={newTask.priority}\n                onChange={(e) => setNewTask({ ...newTask, priority: e.target.value })}\n              >\n                <option value=\"高\">高</option>\n                <option value=\"中\">中</option>\n                <option value=\"低\">低</option>\n              </select>\n            </div>\n            \n            <div className=\"form-field\">\n              <label htmlFor=\"new-due-date\">\n                期限日\n              </label>\n              <input\n                id=\"new-due-date\"\n                type=\"date\"\n                value={newTask.due_date}\n                onChange={(e) => setNewTask({ ...newTask, due_date: e.target.value })}\n              />\n            </div>\n          </div>\n\n          <div className=\"form-field\">\n            <label htmlFor=\"new-category\">\n              カテゴリ\n            </label>\n            <select\n              id=\"new-category\"\n              value={newTask.category_id}\n              onChange={(e) => setNewTask({ ...newTask, category_id: e.target.value })}\n            >\n              <option value=\"\">カテゴリなし</option>\n              {categories.map((category) => (\n                <option key={category.id} value={category.id}>\n                  {category.name}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div className=\"modal-actions\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"cancel-button\"\n            >\n              キャンセル\n            </button>\n            <button\n              type=\"submit\"\n              className=\"save-button\"\n              disabled={loading}\n            >\n              {loading ? '保存中...' : '保存'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default AddTaskModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}